Описание пользовательских интерфейсов
## Меню экранов 
Менеджер видит экраны:

- CPC Дашборд
- Работа с данными
- Оптимизация расходов (СРС и САС графики) 
- Рекомендации 
- СРА офферы
- Данные по клиентам
- Статистика СРА
- Паблишеры
- Выплаты 

Паблишерская часть: 

- Офферы 
- Статистика
- Отчеты
- Профиль
- Выплаты 
## СРА Личный кабинет
### Раздел офферов для менеджеров
Экран состоит из таблицы - карточек офферов и кнопки создания нового оффера. 
#### Форма создания/редактирования
Кнопка создания нового оффера открывает форму содержащую следующие поля:

- Название оффера - Название которое отображается паблишеру (50 сим)
- Описание - Описание оффера которое отображается паблишеру (3000с)
- Логотип - квадратный пнг файл (опц)
- Категория продукта - Выпадающий список из уникальных вариантов “product\_category\_name”
- Если “product\_category\_name” = “Договор на текущий счет для дебетовой карты”, то появляется выпадающий список из уникальных вариантов поля “card\_type\_name”
- Ссылка на страницу продукта - Ссылка на которую пользователя направляет бэк после сбора данных 
- Чекбокс - Использовать сложную систему оплаты? 

Если чекбокс не нажат:

- СРА - Сумма к выплате за продажу (Conversion\_state = 1)

Если чекбокс нажат:

- За продажу - Сумма к выплате за продажу (Conversion\_state = 1)
- За резидентство - Сумма к выплате если (nonresident\_flag = R)
- За бизнес - Сумма к выплате если (businessman\_flag = 1) 
- Процентная часть - Процент который выплачивается паблишеру от значения contract\_sum

После заполнения всех полей становиться активной кнопка сохранить. 

Кнопка отмена всегда активна и закрывает форму. 

Форма редактирования состоит из тех же полей, при вызове формы редактирования конкретного оффера форма предзаполняется данными из него и при сохранении перезаписывает поля в которые внесены изменения. 
#### Таблица офферов 
Список офферов состоит из строк - офферов и следующих столбцов:

- Название 
- Логотип 
- Категория продукта
- СРА - для простых офферов просто выводит СРА, для сложных минимально и максимально возможные размеры выплат
- Кнопка редактирования - открывает форму редактирования
- Кнопка деактивации - скрывает оффер из видимости для паблишеров или соответственно открывает
- Для деактивированных офферов появляется кнопка удалить. Для удаления должна всплывать формочка подтверждения действия. 
### Раздел офферов. Паблишер
Экран состоит из списка офферов и кнопки просмотра оффера 
#### Список офферов 
Список состоит из строк офферов и следующих столбцов 

- Название 
- Логотип 
- Категория продукта
- СРА - для простых офферов просто выводит СРА, для сложных минимально и максимально возможные размеры выплат
- Кнопки копирования ссылки 
- Кнопки просмотра оффера - открывает экран просмотра оффера
#### Просмотр оффера 
Страница оффера состоит из:

- Кнопки назад ко всем офферам
- Названия оффера
- Логотипа 
- Описания оффера 
- СРА - для простых офферов просто выводит СРА, для сложных минимально и максимально возможные размеры выплат
- Реферальную ссылку
### Логика формирования и работы реферальных ссылок
Реферальная ссылка это ссылка на внутренний обработчик пользователя, который собирает данные о пользователе и выполняет редирект на нужную страницу продукта. 

Структура ссылки: {URL обработчика}+{Publisher\_Id}+{Offer\_id}

При клике пользователя по ссылки должны записываться следующие параметры:

- time\_stamp - Время и дата клика
- Clik\_id - Уникальный номер клика, всегда генерируется
- IP - IP адрес, нужен для работы с другими параметрами
- client\_id - Уникальный номер клиента если нет существующего клиента с тем же IP, то генерируется
- Conversion\_state - всегда заполняется нулем
- Publisher\_Id - Уникальный номер паблишера, берется из параметра ссылки
- Offer\_id - Уникальный номер оффера, берется из параметра ссылки
- brauser - Браузер пользователя, собирается как-то при клике :)
- Country - Страна пользователя 
- device - Устройство пользователя
- Conversion\_state - всегда заполняется нулем 

После сбора данных о пользователе, посетитель ссылки перенаправляется на ссылку указанную в поле “Ссылка на страницу продукта” оффера с Offer\_id указанным в параметре ссылки

### Данные по клиентам
Это экран для менеджеров который позволяет загружать данные о конверсиях и выгружать данные по кликам. 
#### Загрузка
Загрузка позволяет загружать данные выгружаемые из банка (файл с данными) 

Данные должны конектиться с существующими данными по полю {client\_id}, НО это поле в данных банка бывает не уникальным из-за нескольких покупок клиента. В таком случае коннект использует следующие условия:

- Если число полей в базе с уникальными Clik\_id и одинаковым client\_id больше чем полей с одинаковым client\_id в загружаемом файле, то в порядке от старых кликов к новым данные заполняются данными из файла
- Если число полей в базе с уникальными Clik\_id и одинаковым client\_id меньше чем полей с одинаковым client\_id в загружаемом файле, то в порядке от старых кликов к новым данные заполняются данными из файла и потом генерируются поля с новыми Clik\_id и данными идентичными тем, что содержаться в других кликах 
- Если в базе нет client\_id совпадающего с client\_id в загружаемом отчете, то эта строка не вносится в базу как инфа о старых клиентах 

Также при загрузке заполняется поле “Cost\_conversion” на основе информации о выплате в описании оффера. Для простых офферов просто заполняется значением СРА, для сложных выполняется проверка выполнения условий выплат и по тем условиям где выплата есть сумма складывается и записывается в поле 
#### Выгрузка 
Функционал выгрузки состоит из календарика выбора периода выгрузки (выгружает все строки с time\_stamp попадающим в этот период) и кнопки выгрузить которая формирует из строк и столбцов в БД CSV/XLSX файл и загружает у пользователя. 

### Отчеты (опционально) 
На экране отчеты паблишер может выгрузить информацию по кликам которые содержат Publisher\_Id соответствующее паблишеру.

Функционал выгрузки состоит из календарика выбора периода выгрузки (выгружает все строки с time\_stamp попадающим в этот период) и кнопки выгрузить которая формирует из строк и столбцов в БД CSV/XLSX файл и загружает у пользователя. В отчет попадают только следующие столбцы:

- time\_stamp - Дата и время
- Clik\_id - ID клика
- client\_id - ID Клиента
- Offer\_id - Должен заменяться на название оффера и подписываться как Оффер 
- brauser - Браузер
- Country - Страна
- device - Устройство
- Cost\_conversion - Заработок

### Статистика по СРА
Экран статистики позволяет отображать статистику в нескольких группировках. 

Publisher > Offer - Основная 

Offer > Publisher - Опционально если успеем 

Также нужно сделать выбор даты за который выводится отчет в календарике 

Таблица статистики состоит из строк - группировок в которых выводятся результаты суммирования по всем строкам и следующих столбцов:

- Publisher - Логин паблишера имеющего Publisher\_Id группы по паблишеру 
- Offer - название оффера имеющего Offer\_id группы по офферу
- Клики - число строк в группе 
- Продажи - число строк в группе с Conversion\_state = 1
- Конверсия - Продажи/Клики\*100%
- Сумма контрактов - Сумма строк по полю contract\_sum
- Сумма средних балансов - Сумма строк по полю current\_balance\_avg\_sum
- Выплаты паблишерам - Сумма строк по полю Cost\_conversion

Референс: 

![](Aspose.Words.629b2ed5-a8fb-4b6d-a653-9ab710277c09.001.png)

### Статистика по СРА паблишер
Экран статистики позволяет отображать статистику в группировке по офферам, и паблишер видит только данные соответствующие его Publisher\_Id

Также нужно сделать выбор даты за который выводится отчет в календарике 

Таблица статистики состоит из строк - группировок по офферам в которых выводятся результаты суммирования по всем строкам и следующих столбцов:

- Offer - название оффера имеющего Offer\_id группы по офферу
- Клики - число строк в группе 
- Продажи - число строк в группе с Conversion\_state = 1
- Конверсия - Продажи/Клики\*100%
- Заработок - Сумма строк по полю Cost\_conversion
### Паблишеры 
Содержит таблицу с инфой о паблишерах

Таблица состоит из строк - паблишеров и следующих столбцов:

Паблишер - Логин паблишера 

Имя - Имя и фамилия паблишера 

Реквизит - Отображает тип основного реквизита, по клику всплывает окно с подробной информацией о реквизите и кнопкой скопировать 

Кнопка деактивации аккаунта - блокирует паблишеру возможность логина

### Профиль 
В профиле паблишер может изменить свои:

- Имя
- Фамилия
- Отчество
- Почта
- Пароль

И добавить или удалить реквизиты.
#### Добавление реквизита
Паблишер может добавить бесконечное количество реквизитов, основным реквизитом является тот что был добавлен первым. При удалении реквизита, основным становится тот что добавлен после него. Удаление единственного реквизита невозможно. 

Форма добавления реквизита содержит поля:

- Выбор между физическим и юридическим лицом

Если выбрано юридическое лицо:

- Полное наименование;
- Адрес компании;
- ИНН
- КПП;
- Номер расчетного **счета**;
- Номер кор. **счета**;
- БИК;
- Номер телефона
- Адрес электронной почты

Если физическое лицо:

- Номер банковской карты 
- Имя владельца на карте
- Название банка
- Номер банковского счета
- Дата истечения действия карты
- Дата рождения
- Адрес
- Страна

### Выплаты Менеджер 
Экран выплаты состоит из информации о статистике выплат паблишерам, и функционала для выплат 
#### Таблица
Таблица состоит из строк паблишеров и следующих столбцов:

- Паблишер - Логин паблишера
- Заработано паблишером - Сумма заработков паблишера за весь период сбора статистики 
- Выплаченную паблишеру - Сумма выплаченная паблишеру за все время
- Подлежит выплате - Разница между заработком и выплатой
- Кнопка просмотра - Открывает экран выплат паблишеру 
- Кнопка выплаты - Открывает форму добавления выплаты
#### Просмотр выплат
Открывает для этого паблишера таблицу из строк - выплат и столбцов:

- Дата выплаты
- ID выплаты - уникальный номер выплаты
- Выплачено - Выплаченная сумма 
- Реквизит - отображает тип основного реквизита паблишера и по клику позволяет просмотреть данные для выплаты
- Кнопку удаления выплаты
#### Кнопка выплаты 
Открывает форму в которой отображается основной реквизит паблишера и возможность ввести выплаченную сумму и создать выплату

### Выплаты паблишер
Экран состоит из таблицы из строк - выплат и столбцов:

- Дата выплаты
- ID выплаты - уникальный номер выплаты
- Выплачено - Выплаченная сумма 

Верхней строкой выводится сумма по всем выплатам 

Столбцы отсортированы по дате и первыми выводятся самые недавние выплаты

## Дашборд классических каналов 
### Схема движения данных:
![](Aspose.Words.629b2ed5-a8fb-4b6d-a653-9ab710277c09.002.jpeg)

### Интерфейс Дашборд
Дашборд имеет общую вкладку со сводной таблицей по всем каналам, и вкладки соответствующие каждому каналу с таблицей анализа компаний. 

%

Общая вкладка содержит таблицу разделенную на строки - каналы, каждую из которых можно развернуть на строки - компании. И следующих столбцов: 

- Название канала
- Название компании (при разворачивании) 
- Объявление
- Охват 
- Взаимодействия (клики) 
- Стоимость взаимодействия (CPC)
- Продажи
- CAC
- LTV 
- ARPU - средняя прибыль с одного пользователя за период отчета (прибыль от привлеченных пользователей за период/число привлеченных пользователей) 
- ROI - (LTV - CAC)/CAC 

Каждый столбец должен иметь возможность сортировки по значению столбца, по умолчанию строки отсортированы по столбцу “Продажи”

На отдельных вкладках - каналах должна отображаться аналогичная таблица но со строками - компаниями внутри этого канала и с возможностью раскрытия компании до объявлений. 

### Интерфейс Работа с данными
На странице Работа с данными пользователь должен видеть кнопку - загрузить данные, кнопку добавить канал и лог загруженных файлов. 
#### Кнопки
Кнопка загруженных файлов открывает форму загрузки, где пользователь должен:

- Выбрать из выпадающего списка канал по которому происходит загрузка или вариант “Все”
- Выбрать источник данных через контрол: Рекламные кабинеты/Внутренние данные 
- Увидеть возможность скачать шаблон для ввода данных
- Ввести период статистики через календарик 
- Выбрать файл для загрузки 

Кнопка добавления канала позволяет ввести название для нового канала и создать его. 
#### Таблица лога
Таблица лога состоит из строк - операций по загрузке времени и следующих столбцов:

Отметка времени - дата загрузки файла

Название файла - название загруженного файла, является активной ссылкой для скачивания

Тип данных - Рекламные кабинеты/Внутренние данные 

Период - Период введённый при добавлении файла

Кнопка удаления файла - должна стирать данные загруженные из этого файла

## СРС и САС графики
### Экран графиков

Экран графиков состоит из блока настроек вывода графика и самого графика

Блок настроек содержит:

- Выбор типа метрик CPC/CAC 
- Выбор типа графика по дням / объем продаж 
- Выбор канала 
- Выбор периода в календарике

При нажатии кнопки применить фильтры должен строиться соответствующий график
### Логика построения графиков
Для построения любого графика используются данные с отметкой даты включительно попадающей в диапазон выбранный в фильтре и соответствующие каналу 
#### График СРС по Дням
По оси X мы выводим дни и по оси y указываем какое СРС было в этот день. Точки где СРС = 0 в график не выводятся 
#### График СРС по продажам
Для каждой уникальной пары СРС и объема продаж в строке попадающей в условия фильтра мы ставим точку на графике, где по оси X число продаж, а по оси Y СРС

Линия графика проводится либо через единственную точку для определенного числа продаж или через точку соответствующую среднему значению СРС для определенного значения числа продаж 
#### График САС по Дням
По оси X мы выводим дни и по оси y указываем какое САС было в этот день. Точки где САС = 0 в график не выводятся 
#### График САС по продажам
Для каждой уникальной пары САС и объема продаж в строке попадающей в условия фильтра мы ставим точку на графике, где по оси X число продаж, а по оси Y САС

Линия графика проводится либо через единственную точку для определенного числа продаж или через точку соответствующую среднему значению САС для определенного значения числа продаж 

### Дополнительная вкладка на экране Работа с данными + бэк
На вкладке загрузка данных по дням должна быть возможность загрузить файл соответствующий шаблону “СРС и САС” ([5 лист](https://docs.google.com/spreadsheets/d/19EyEruKSGtKFDwqFWmQIGaMdQ_5hvpwEQ6NN4kmQgOE/edit?usp=sharing)) без каких либо дополнительных полей 

Соответственно на бэке файл должен обрабатываться и заполнять таблицу со следующими столбцами: 

- Канал - принимается из файла
- Дата - принимается из файла
- СРС - принимается из файла
- Расход - принимается из файла
- Продажи - принимается из файла
- САС - рассчитывается как Расход/Продажи


## Экран рекомендаций
Экран рекомендаций состоит из списка рекомендаций в порядке от самых новых к самым старым. Рекомендация это текстовое сообщение

### Логика формирования рекомендаций 
При любой загрузке файлов в систему, происходит проверка по всем условиям отправки рекомендаций. 
#### Снижение СРС
Условие: Для каждой компании, в данных по дням сравнить СРС за последний завершенный день со средним СРС за месяц по этой компании. И если СРС будет меньше среднего, то отправляется сообщение

Сообщение: Обнаружено снижение конкуренции за клик по компании {компания где выполнено условие}! Рекомендуется увеличить дневной расход по компании с целью получить больше продаж по выгодной стоимости. 

#### Рост СРС
Условие: Для каждой компании, в данных по дням сравнить СРС за последний завершенный день со средним СРС за месяц по этой компании. И если СРС будет выше среднего, то отправляется сообщение

Сообщение: Обнаружена повышенная конкуренции за клик по компании {компания где выполнено условие}! Рекомендуется снизить дневной расход по компании с для повышения эффективности использования бюджета. 




